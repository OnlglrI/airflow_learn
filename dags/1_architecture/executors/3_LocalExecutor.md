# Local Executor

**LocalExecutor** выполняет задачи, создавая процессы в контролируемом режиме **на ноде scheduler’а**.

### Параметр `parallelism`

* Ограничивает количество одновременно создаваемых процессов
* Предотвращает перегрузку ноды
* **Должен быть больше 0**

---

### Как работает LocalExecutor

* При старте создаётся количество процессов, равное `self.parallelism`
* Используется очередь `task_queue` для:

  * приёма задач
  * распределения задач между worker-процессами
* Worker-процессы постоянно работают и ждут задачи
* Как только executor получает сигнал shutdown:

  * worker’ам отправляется *poison token*
  * процессы корректно завершаются

Используемый класс процессов: **QueuedLocalWorker**

---

### Примечание

Если в секции `[core]` файла `airflow.cfg` настроено несколько Scheduler’ов с
`executor = LocalExecutor`, то **каждый Scheduler запускает свой LocalExecutor**.

➡️ В результате задачи обрабатываются распределённо между машинами, где запущены Scheduler’ы.

---

### Важный момент

**Перезапуск Scheduler’а**

* Если Scheduler перезапускается, другим Scheduler’ам может потребоваться время, чтобы:

  * обнаружить *осиротевшие* (orphaned) задачи
  * перезапустить их или пометить как failed

---

### Примечание (изменения в версиях)

В предыдущих версиях Airflow существовала возможность настроить LocalExecutor с неограниченным параллелизмом:

```text
self.parallelism = 0
```

❌ Эта возможность **удалена в Airflow 3.0.0**, чтобы избежать перегрузки scheduler-ноды.

---